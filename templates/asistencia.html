<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEM{{i.id}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous">
</head>
  <body>

    <h2>Asistencia - Periodo {{ periodo }}</h2>
    <form method="POST">
      <select name="periodo" onchange="this.form.submit()">
        <option value="A" {% if periodo=='A' %}selected{% endif %}>Periodo A</option>
        <option value="B" {% if periodo=='B' %}selected{% endif %}>Periodo B</option>
        <option value="C" {% if periodo=='C' %}selected{% endif %}>Periodo C</option>
      </select>
    </form>

    <form method="POST">
      <input type="hidden" name="guardar" value="1">
      <table border="1">
        <tr>
          <th>Alumno</th>
          {% for f in fechas %}<th>{{ f.strftime("%d/%m") }}</th>{% endfor %}
        </tr>
        {% for est in estudiantes %}
        <tr>
          <td>{{ est.nombres }} {{ est.apellido_paterno }}</td>
          {% for f in fechas %}
            {% set check = registros | selectattr("user_id","equalto",est.id) | selectattr("fecha","equalto",f) | map(attribute="presente") | list %}
            <td><input type="checkbox" name="check_{{ est.id }}_{{ f }}" {% if check and check[0]==1 %}checked{% endif %}></td>
          {% endfor %}
        </tr>
        {% endfor %}
      </table>
      <button type="submit">Guardar asistencia</button>
    </form>

    </body>
</html>